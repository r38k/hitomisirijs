---
import { SITE_TITLE } from "../../consts";

const navItems = [
  { id: 'home', label: 'Home', jp: 'ホーム', href: '/' },
  { id: 'blog', label: 'Blog', jp: '記録', href: '/blog' },
  { id: 'about', label: 'About', jp: '人物', href: '/about' },
];

const pathname = Astro.url.pathname.replace(import.meta.env.BASE_URL, '');
---

<header class="site-header">
  {/* Subtle grain texture overlay */}
  <div class="grain-overlay"></div>

  {/* Floating ceramic form - abstract pottery shape */}
  <div class="ceramic-shape">
    <svg viewBox="0 0 200 200">
      <defs>
        <linearGradient id="ceramic" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" stop-color="var(--ceramic-light)" />
          <stop offset="50%" stop-color="var(--ceramic-medium)" />
          <stop offset="100%" stop-color="var(--ceramic-dark)" />
        </linearGradient>
      </defs>
      {/* Organic pottery-like shape */}
      <path
        d="M100 20
           C140 20, 170 50, 175 90
           C180 130, 160 160, 140 175
           C120 190, 80 190, 60 175
           C40 160, 20 130, 25 90
           C30 50, 60 20, 100 20Z"
        fill="url(#ceramic)"
      />
      {/* Inner hollow - like a bowl */}
      <ellipse
        cx="100"
        cy="70"
        rx="45"
        ry="25"
        fill="var(--bg-primary)"
        opacity="0.5"
      />
    </svg>
  </div>

  {/* Header content */}
  <div class="header-content">
    {/* Logo / Title area */}
    <div class="logo">
      <h1>
        <a href="/">{SITE_TITLE}</a>
      </h1>
    </div>

    {/* Navigation */}
    <nav class="navigation">
      {navItems.map((item) => {
        const subpath = pathname.match(/[^\/]+/g);
        const isActive = item.href === pathname || item.href === '/' + (subpath?.[0] || '');

        return (
          <a
            href={item.href}
            class:list={['nav-item', { active: isActive }]}
            data-jp={item.jp}
          >
            {/* Tech indicator dot */}
            <span class="indicator-dot"></span>

            <span class="label">{item.label}</span>

            {/* Japanese subtitle - appears on hover */}
            <span class="jp-label">{item.jp}</span>
          </a>
        );
      })}
    </nav>
  </div>

  {/* Decorative tech line */}
  <div class="tech-line">
    {/* Glowing accent point */}
    <div class="accent-point"></div>
  </div>
</header>

<style>
  .site-header {
    position: relative;
    padding: var(--space-md) var(--space-xl);
    background: var(--gradient-bg);
    font-family: var(--font-mono);
    overflow: hidden;
  }

  /* Grain texture overlay */
  .grain-overlay {
    position: absolute;
    inset: 0;
    opacity: var(--opacity-grain);
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
    pointer-events: none;
  }

  /* Floating ceramic shape */
  .ceramic-shape {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 150px;
    height: 150px;
    opacity: var(--opacity-ceramic-shape);
    pointer-events: none;
  }

  .ceramic-shape svg {
    width: 100%;
    height: 100%;
    filter: var(--blur-subtle);
  }

  /* Header content layout */
  .header-content {
    position: relative;
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    z-index: 1;
  }

  /* Logo / Title */
  .logo {
    display: flex;
    flex-direction: column;
    gap: var(--space-xs);
  }

  .logo h1 {
    margin: 0;
    font-size: var(--text-md);
    font-weight: 400;
    letter-spacing: var(--tracking-wider);
    text-transform: uppercase;
    opacity: 0.9;
  }

  .logo h1 a {
    color: var(--text-ceramic);
    text-decoration: none;
    transition: var(--transition-ease);
  }

  .logo h1 a:hover {
    opacity: var(--opacity-hover);
  }

  /* Navigation */
  .navigation {
    display: flex;
    gap: var(--space-lg);
    align-items: center;
  }

  .nav-item {
    text-decoration: none;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--space-sm);
    transition: var(--transition-smooth);
    position: relative;
  }

  .nav-item:hover {
    transform: translateY(-2px);
  }

  /* Indicator dot */
  .indicator-dot {
    width: 4px;
    height: 4px;
    border-radius: 50%;
    background: var(--bg-accent-dark);
    transition: var(--transition-ease);
  }

  .nav-item:hover .indicator-dot,
  .nav-item.active .indicator-dot {
    background: var(--ceramic-light);
    box-shadow: var(--glow-ceramic);
  }

  /* Label */
  .label {
    font-size: var(--text-sm);
    font-weight: 400;
    color: var(--text-secondary);
    letter-spacing: var(--tracking-normal);
    text-transform: uppercase;
    transition: var(--transition-ease);
  }

  .nav-item:hover .label,
  .nav-item.active .label {
    color: var(--text-primary);
  }

  /* Japanese subtitle */
  .jp-label {
    font-size: var(--text-xs);
    color: var(--text-ceramic);
    letter-spacing: var(--tracking-wide);
    opacity: 0;
    transform: translateY(-4px);
    transition: var(--transition-smooth);
    position: absolute;
    top: 100%;
    margin-top: 6px;
    white-space: nowrap;
  }

  .nav-item:hover .jp-label {
    opacity: var(--opacity-hover);
    transform: translateY(0);
  }

  /* Decorative tech line */
  .tech-line {
    position: absolute;
    bottom: var(--space-md);
    left: var(--space-xl);
    right: var(--space-xl);
    height: 1px;
    background: var(--gradient-line);
  }

  /* Glowing accent point */
  .accent-point {
    position: absolute;
    left: 0;
    top: -2px;
    width: 5px;
    height: 5px;
    background: var(--ceramic-light);
    border-radius: 50%;
    box-shadow: var(--glow-ceramic-subtle);
    animation: pulse 3s ease-in-out infinite;
  }

  @keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.4; }
  }

  /* Responsive design */
  @media (max-width: 720px) {
    .site-header {
      padding: var(--space-md) 1em;
    }

    .header-content {
      flex-direction: column;
      gap: var(--space-md);
      align-items: flex-start;
    }

    .navigation {
      gap: var(--space-md);
    }

    .ceramic-shape {
      width: 200px;
      height: 200px;
    }

    .tech-line {
      left: 1em;
      right: 1em;
    }

    .jp-label {
      display: none; /* Hide Japanese labels on mobile for cleaner look */
    }
  }
</style>
